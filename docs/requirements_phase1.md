# A.L.V.A. プロジェクト要件定義書 (Phase 1)

## 1. プロジェクト概要

本プロジェクトは、最終的にはAIコンパニオン「A.L.V.A.」との対話を核としたゲームを目指しますが、**Phase 1ではその基盤となる「宇宙貿易・戦闘シミュレーションゲーム」のコアメカニクスを完成させること**を目的とします。

プレイヤーは宇宙船のパイロットとなり、広大な銀河で交易を行い、海賊や危険な生物と戦いながら生存を目指します。

---

## 2. ユーザーストーリー (Phase 1)

このフェーズでは、システム基盤とゲームループの確立に焦点を当てます。

### 2.1 パイロット（プレイヤー）の視点

**【航行と探索】**
* **US-1:** 私は、**セクターマップ**で銀河のつながりを確認し、目的地へのルートを計画したい。
* **US-2:** 私は、セクター内を**物理挙動（慣性）のある宇宙船**で自由に操作し、ステーションへのドッキングやゲート通過を行いたい。
* **US-3:** I私は、**ジャンプゲート**を使ってセクター間を移動し、異なる経済圏へ旅したい。

**【経済活動】**
* **US-4:** 私は、ステーションで商品を**売買**し、価格差を利用して利益を上げたい。
* **US-5:** 私は、消費されていく在庫や変動する価格を見て、今何を運ぶべきかの戦略的判断を行いたい。

**【戦闘と脅威】**
* **US-6:** 私は、海賊や敵対的なクリーチャー（スペースクラーケン）と遭遇し、**FTLスタイルのリアルタイム戦闘**を行いたい。
* **US-7:** 私は、戦闘においてシールドや武器への**電力配分**を管理し、限られたリソースで勝利を掴みたい。

### 2.2 システム（世界）の視点

**【動的な経済】**
* **US-8:** システムは、**数百〜数千のNPC船**をシミュレートし、実際に物流を生み出すことで経済を回したい。
* **US-9:** システムは、商品の**自然消費（Consumption）**とステーションでの**生産・消費**を行い、常に需要が発生し続ける状態を維持したい。

**【脅威の発生】**
* **US-10:** システムは、経済バランスを調整するため（あるいはプレイヤーへの挑戦として）、海賊や巨大生物をスポーンさせ、NPCやプレイヤーを襲撃させたい。

---

## 3. 機能要件

### 3.1 ゲームループとマップ
* **2D 宇宙空間:**
    * 上下左右に無限（または広大）な2D平面。
    * 慣性移動、スラスター制御。
* **セクターシステム:**
    * 宇宙は多数の「セクター」で構成され、ゲートで接続される（グラフ構造）。
    * 各セクターにはステーション、惑星、アステロイドが存在。

### 3.2 経済シミュレーション (The Living Economy)
* **エージェントベース:**
    * NPC船は個別のエージェントとして資金と貨物を持ち、利益を求めて等しく行動する。
* **自然消費と生産サイクル:**
    * 時間経過で在庫が自然に減少する（自然消費）。
    * ステーションは特定の物資を消費して別の物資を生産する（例：エネルギー＋食料 → 鉱石採掘）。

### 3.3 戦闘システム (FTL-inspired)
* **エンカウント:**
    * 敵シンボル接触で戦闘モードへ移行（シームレスまたはオーバーレイ）。
* **戦闘メカニクス:**
    * 1対1（または多）の艦隊戦。
    * **電力管理:** エンジン、シールド、武器へのエネルギー配分。
    * **クルー:** ダメージコントロールやボーナス効果のためのクルー配置。
    * **自動進行:** ターゲットを指定すれば自動で攻撃。プレイヤー介入は戦術レベルで行う。

### 3.4 UI/UX
* **メインビュー:** 自機の操作と周辺宇宙の表示。
* **情報オーバーレイ:** カーゴ内訳、ステーション取引画面、マップ画面。
* **基本メニュー:** 設定、セーブ/ロード。

---

## 4. ロードマップ (Steps 1-4)

本要件定義書がカバーする開発範囲です。

1.  **Step 1: 経済シミュレーションのプロトタイプ**
    * マップ生成、単純なNPC移動、基本取引。
2.  **Step 2: 経済シミュレーションの深化**
    * 自然消費システム、生産/消費サイクル、物流の可視化。
3.  **Step 3: 脅威と戦闘の実装**
    * 海賊、クラーケンのAI。
    * FTLライクな戦闘ミニゲームの実装。
    * 撃破時の戦利品と経済への影響（Ship Sinking）。
4.  **Step 4: UIの洗練とゲームループの統合**
    * プレイヤー体験としての完成（チュートリアル含まず）。
    * 各種メニュー、HUDの整理。

---

## 5. 技術スタック

*   **Frontend:** TypeScript, Phaser 3 (Rendering/Physics)
*   **Build:** Vite
*   **State/Data:** ECS Pattern (Miniplex or bitECS styled custom implementation)
*   **Persistence:** LocalStorage (Save Data)
